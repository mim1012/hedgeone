<Window x:Class="Hedgeone.UI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Hedgeone.UI"
        mc:Ignorable="d"
        Title="Binance Auto Hedge Trader"
        Height="700" Width="900"
        WindowStartupLocation="CenterScreen">
    <Window.Resources>
        <local:SymbolToBoolConverter x:Key="SymbolToBoolConverter"/>
    </Window.Resources>

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="150"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- API 설정 -->
        <GroupBox Grid.Row="0" Header="API 설정" Padding="10" Margin="0,0,0,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" Text="API Key:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                <TextBox Grid.Column="1"
                         Text="{Binding Config.ApiKey, UpdateSourceTrigger=PropertyChanged}"
                         VerticalAlignment="Center"
                         Padding="5"/>
                <Button Grid.Column="2"
                        Content="연결 테스트"
                        Command="{Binding TestConnectionCommand}"
                        Width="100"
                        Margin="10,0,0,0"
                        Padding="5"/>
            </Grid>
        </GroupBox>

        <!-- 전략 설정 -->
        <GroupBox Grid.Row="1" Header="전략 설정" Padding="10" Margin="0,0,0,10">
            <StackPanel>
                <!-- 심볼 선택 -->
                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                    <TextBlock Text="심볼 선택:" VerticalAlignment="Center" Width="100"/>
                    <RadioButton Content="1000PEPEUSDT"
                                 IsChecked="{Binding Config.SelectedSymbol, Converter={StaticResource SymbolToBoolConverter}, ConverterParameter=1000PEPEUSDT}"
                                 GroupName="Symbol"
                                 Margin="0,0,20,0"
                                 VerticalAlignment="Center"/>
                    <RadioButton Content="CHZUSDT"
                                 IsChecked="{Binding Config.SelectedSymbol, Converter={StaticResource SymbolToBoolConverter}, ConverterParameter=CHZUSDT}"
                                 GroupName="Symbol"
                                 Margin="0,0,20,0"
                                 VerticalAlignment="Center"/>
                    <RadioButton Content="BIOUSDT"
                                 IsChecked="{Binding Config.SelectedSymbol, Converter={StaticResource SymbolToBoolConverter}, ConverterParameter=BIOUSDT}"
                                 GroupName="Symbol"
                                 VerticalAlignment="Center"/>
                </StackPanel>

                <!-- 기본 수량 -->
                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                    <TextBlock Text="기본 수량 CALL_SIZE:" VerticalAlignment="Center" Width="150"/>
                    <TextBox Text="{Binding Config.CallSize, UpdateSourceTrigger=PropertyChanged}"
                             Width="100"
                             Padding="5"/>
                </StackPanel>

                <!-- TP%, Trailing%, 최대보유 -->
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="TP%:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                    <TextBox Text="{Binding Config.TakeProfitPct, UpdateSourceTrigger=PropertyChanged}"
                             Width="60"
                             Padding="5"
                             Margin="0,0,20,0"/>

                    <TextBlock Text="트레일링%:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                    <TextBox Text="{Binding Config.TrailingPct, UpdateSourceTrigger=PropertyChanged}"
                             Width="60"
                             Padding="5"
                             Margin="0,0,20,0"/>

                    <TextBlock Text="최대보유(5m):" VerticalAlignment="Center" Margin="0,0,5,0"/>
                    <TextBox Text="{Binding Config.MaxHoldBars, UpdateSourceTrigger=PropertyChanged}"
                             Width="60"
                             Padding="5"/>
                </StackPanel>
            </StackPanel>
        </GroupBox>

        <!-- 실시간 상태 -->
        <GroupBox Grid.Row="2" Header="실시간 상태" Padding="10" Margin="0,0,0,10">
            <DataGrid ItemsSource="{Binding Positions}"
                      AutoGenerateColumns="False"
                      IsReadOnly="True"
                      CanUserAddRows="False"
                      CanUserDeleteRows="False"
                      GridLinesVisibility="All"
                      HeadersVisibility="Column">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="심볼" Binding="{Binding Symbol}" Width="100"/>
                    <DataGridTextColumn Header="대세" Binding="{Binding Regime}" Width="60"/>
                    <DataGridTextColumn Header="포지션" Binding="{Binding Position}" Width="80"/>
                    <DataGridTextColumn Header="수량" Binding="{Binding Quantity}" Width="80"/>
                    <DataGridTextColumn Header="진입가" Binding="{Binding EntryPrice, StringFormat=F4}" Width="100"/>
                    <DataGridTextColumn Header="현재가" Binding="{Binding CurrentPrice, StringFormat=F4}" Width="100"/>
                    <DataGridTextColumn Header="PnL" Binding="{Binding Pnl}" Width="80"/>
                    <DataGridTextColumn Header="헷지" Binding="{Binding Hedge}" Width="80"/>
                </DataGrid.Columns>
            </DataGrid>
        </GroupBox>

        <!-- 로그 -->
        <GroupBox Grid.Row="3" Header="로그" Padding="10" Margin="0,0,0,10">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <TextBox Text="{Binding LogText, Mode=OneWay}"
                         IsReadOnly="True"
                         TextWrapping="Wrap"
                         Background="Black"
                         Foreground="LimeGreen"
                         FontFamily="Consolas"
                         BorderThickness="0"/>
            </ScrollViewer>
        </GroupBox>

        <!-- 제어 버튼 -->
        <StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Center">
            <Button Content="전략 시작"
                    Command="{Binding StartStrategyCommand}"
                    Width="120"
                    Height="40"
                    Margin="0,0,10,0"
                    FontSize="14"
                    FontWeight="Bold"/>
            <Button Content="일시정지"
                    Command="{Binding PauseStrategyCommand}"
                    Width="120"
                    Height="40"
                    Margin="0,0,10,0"
                    FontSize="14"
                    FontWeight="Bold"/>
            <Button Content="즉시 종료"
                    Command="{Binding StopStrategyCommand}"
                    Width="120"
                    Height="40"
                    FontSize="14"
                    FontWeight="Bold"
                    Background="#FFCC0000"
                    Foreground="White"/>
        </StackPanel>
    </Grid>
</Window>
